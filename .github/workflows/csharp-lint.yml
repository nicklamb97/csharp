name: Lint C# Files and Create PR

on:
  push:
    branches: [ main ]
    paths:
      - '**.cs'  # Trigger on .cs file changes

env:
  MODEL_NAME: 'mistralai/Mistral-Nemo-Instruct-2407'
  MODEL_FILE: 'Mistral-Nemo-Instruct-2407.Q4_K_M.gguf'

jobs:
  lint_and_fix:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout C# repo
      uses: actions/checkout@v3
      with:
        fetch-depth: 0

    - name: Get changed files
      id: changed-files
      run: |
        changed_files=$(git diff --name-only HEAD^ HEAD | grep '\.cs$' || true)
        if [ -z "$changed_files" ]; then
          echo "No .cs files changed"
          exit 0
        fi
        echo "files=$changed_files" >> $GITHUB_OUTPUT

    - name: Install .NET SDK
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: '7.x'  # Use the appropriate .NET version

    - name: Create temp project and run dotnet format
      if: steps.changed-files.outputs.files
      run: |
        dotnet new console -n TempProject
        cd TempProject
        rm Program.cs
        for file in ${{ steps.changed-files.outputs
